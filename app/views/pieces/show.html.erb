<% set_meta(
    :keywords => @piece.tag_list,
    :description => @piece.description,
    :og => {:type => "website",
            :description => @piece.description,
            :image => @piece.image.url(:embed), 
            :title => @piece.title,
            :description => @piece.description,

            }, 
:twitter => {
      :card => "photo",
      :site => "@#{@piece.user.profile.twitter}",
      :image => {
              :url => @piece.image.url(:embed)
            },
      :title => @piece.title,
      :description => @piece.description,
      :image =>  @piece.image.url(:embed),
      :url => user_piece_path(:id => @piece.id, :user_slug => @piece.user.profile.slug)
            
    }
    ) 
%>
<% content_for(:head) do %>
  <link rel="alternate" type="application/json+oembed"
    href="<%= root_url %>oembed?url=<%= piece_url(@piece) %>&format=json"
    title="Bacon Lollys oEmbed Profile" />
<% end %>


<div>
<br/>
<div class="pull-right">
  <div class="pull-right" style="margin-left:5px;">
  <% unless current_user == nil %>
  <% if  UserFav.where(:user_id => current_user.id, :piece_id => @piece.id).exists? %>
          <%= link_to raw("<i class='glyphicon glyphicon-heart-empty'></i>  Un-Love"), delete_user_favs_path(:user_fav => {:piece_id => @piece.id, :user_id => current_user.id}), :remote => true, class: "btn fav btn-info pull-right btn-large", :method => :delete %>
      <% else %>
        <%= link_to raw("<i class='glyphicon glyphicon-heart'></i>  Love"), user_favs_path(:user_fav => {:piece_id => @piece.id,:user_id => current_user.id}), :remote => true, class: "btn fav btn-large btn-info pull-right", :method => :post %>
  <% end %>
   <% end %>
   </div>
   <%= render 'shared/collect', :piece => @piece %>
</div>
<h2>
  <%= truncate(@piece.title.capitalize, :length => 50) %><br/>
  <small class="pull-left">by <%= link_to @piece.user.profile.display_name || @piece.user.name, vanity_url_path(@piece.user.profile) %></small>
  <span class="pull-left">
  <%#= render 'follow_form', :html => {class:  "pull-right"} %>
  </span>
</h2  >
  <br/>
  <hr/>
</div>


<div class="clearfix">
  <div class="text-center">
  <%= image_tag @piece.image.url(), :class => "img-responsive pull-center", :id => "piece" %>
  </div>
  <hr/>
  <div class="col-md-8">
     <label class="label label-primary">
      <i class="glyphicon glyphicon-eye-open white"></i>
      <%= @piece.views.to_i %> Views
    </label> 
    &nbsp;
    <label class="label label-info">
      <i class="glyphicon glyphicon-heart"></i>
      <%=  pluralize(@piece.favourited_by.count, 'Love' ) %>
    </label> 
    &nbsp;
    <% @piece.tag_list.each do |tag| %>
      <label class="label label-default">
        <i class="glyphicon glyphicon-tag white"></i>
      <%= link_to tag, tagged_pieces_path(:tag => tag) %>
    </label> &nbsp;
    <% end %> 
    <br/><br/>
     <p class="well">
      <%= auto_link(@piece.description, :html => { :target => '_blank' }) %>
    </p>
    <p>
      <strong>Dimensions:</strong>
      <%= @piece.dimensions %>
    </p>
  </div>
  <div class="col-md-4">
   
    <!-- <div class="panel panel-default">
        <div class="panel-heading "><h5 class=""> Dope or Nope?</h5></div>
        <div class="panel-body">

              <%#= link_to raw("<i class='glyphicon glyphicon-thumbs-up'></i>  Dope (#{@piece.get_likes.size})"), dope_path(:id => @piece.id), :remote => true, class: "btn fav btn-sm btn-success", :method => :post %>

                  <%#= link_to raw("<i class='glyphicon glyphicon-thumbs-down'></i>  Nope (#{@piece.get_dislikes.size})"), nope_path(:id => @piece.id), :remote => true, class: "btn btn-sm fav btn-danger", :method => :post %>        
        </div>
        </div> -->
      <div class="panel panel-default">
        <div class="panel-heading "><h5 class=""><i class='glyphicon glyphicon-share-alt'></i> Share</h5></div>
        <div class="panel-body">
          <%= like_button(402079716609857, :send => true) %>
          <br/><br/>
          <%= tweet_button(via: "artupio", url: "#{piece_url(@piece)}", text: "Nice #art '#{@piece.title} by #{@piece.user.profile.display_name}' :", count: "none") %>

          <%= pinit_button %>
          <%= google_plus_button %>
          <h6>Short Link:</h6>
          <input value="<%= short_url(@piece.id) %>" cols="100"
          />
          <h6>Embed Code:</h6>

          <input cols="30" rows="5"
          value='<iframe style="border:none;" src="<%= embed_url(:id => @piece.id, :user_slug => @piece.user.profile.slug) %>" width="600px" height="600px"/></iframe>
          <br/>
          <a href="<%= user_piece_url(:id => @piece.slug, :user_slug => @piece.user.profile.slug ) %>" target="_blank"><%= @piece.title %></a> by <a href="<%= vanity_url_url(@piece.user.profile.slug) %>" target="_blank"><%= @piece.user.profile.display_name %></a> on <a href="http://www.artup.io" target="_blank">artup.io</a>
          ' />
    
        </div>
        </div>

  <br/>
    <% unless @piece.favourited_by == [] %>
      <div class="panel panel-info">
        <div class="panel-heading "><h5 class="white"><i class='glyphicon glyphicon-heart'></i> Loved By</h5></div>
        <div class="panel-body">
          <% @piece.favourited_by.limit(10).each do |user| %>
            <%= link_to(image_tag(user.profile.image.url(:thumb), :class => "img-circle"), vanity_url_path( :id => user.profile.slug)) %>
          <% end %>
        </div>
        </div>
    <% end %>

    <% unless @piece.collections == [] %>
      <div class="panel panel-primary">
        <div class="panel-heading "><h5 class="white"><i class='glyphicon glyphicon-th-large'></i> Collected By</h5></div>
        <div class="panel-body">
          <% @piece.collections.limit(10).each do |collection| %>
            <%= link_to(image_tag(collection.user.profile.image.url(:thumb), :class => "img-circle"),  collection ) %>
          <% end %>
        </div>
        </div>
    <% end %>


    </div>
    </div>


    <br/><br/>
    <% if current_user && current_user.admin? %>
      <%= link_to 'Edit', edit_piece_path(@piece), :class => "pull-right" %>
    <% end %>
         
  </div>

</div>



<hr/>

<br/>
<br/>



