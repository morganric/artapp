

<div class="pull-right">
  <% if UserFav.where(:user_id => current_user.id, :piece_id => @piece.id).exists? %>
          <%= link_to raw("<i class='glyphicon glyphicon-heart-empty'></i>  Un-Favourite"), delete_user_favs_path(:user_fav => {:piece_id => @piece.id, :user_id => current_user.id}), :remote => true, class: "btn fav btn-info", :method => :delete %>
      <% else %>
        <%= link_to raw("<i class='glyphicon glyphicon-heart'></i>  Favourite"), user_favs_path(:user_fav => {:piece_id => @piece.id,:user_id => current_user.id}), :remote => true, class: "btn fav btn-info", :method => :post %>
  <% end %>
</div>

<h1>
  <%= @piece.title %>
  <small>by <%= link_to @piece.user.name, vanity_url_path(@piece.user.profile) %></small>
</h1>

<hr/>

<div class="row clearfix">
  <div class="col-md-8 ">
    <%= image_tag @piece.image.url(:piece), :class => "img-responsive"%>
  </div>
  <div class="col-md-4">
    <p class="well">
      <%= @piece.description %>
    </p>
    <p>
      <strong>Dimensions:</strong>
      <%= @piece.dimensions %>
    </p>
    <label class="label label-primary">
      <i class="glyphicon glyphicon-eye-open white"></i>
      <%= @piece.views.to_i %> views
    </label> 
    <br/>

    <label class="label label-info">
      <i class="glyphicon glyphicon-heart"></i>
      <%= @piece.favourited_by.count %> Favourites
    </label> 
    <br/>
    <% @piece.tag_list.each do |tag| %>
      <label class="label label-default">
        <i class="glyphicon glyphicon-tag white"></i>
      <%= link_to tag, tagged_pieces_path(:tag => tag) %>
    </label> &nbsp;
    <% end %>  
    <br/><br/>
    <% unless @piece.favourited_by == [] %>
      <div class="panel panel-info">
        <div class="panel-heading "><h5 class="white"><i class='glyphicon glyphicon-heart'></i> Favourited By</h5></div>
        <div class="panel-body">
          <% @piece.favourited_by.limit(10).each do |user| %>
            <%= link_to(image_tag(user.profile.image.url(:thumb), :class => "img-circle"), vanity_url_path( :id => user.profile.slug)) %>
          <% end %>
        </div>
    <% end %>
    </div>
    </div>

    <br/><br/>
    <% if current_user && current_user.admin? %>
      <%= link_to 'Edit', edit_piece_path(@piece), :class => "pull-right" %>
    <% end %>
         
  </div>

</div>



<hr/>

<br/>
<br/>
